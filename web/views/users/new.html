<!-- 用户新增页面 -->
<div>
    <!-- 页面标题 -->
    <div id="page-title" hx-swap-oob="true">新增用户</div>

    <!-- 面包屑 -->
    <nav class="breadcrumb" aria-label="breadcrumbs" style="margin-bottom: 1.5rem;">
        <ul>
            <li><a href="/dashboard" hx-get="/dashboard" hx-target="#main-container" hx-swap="innerHTML"
                    hx-push-url="true">首页</a></li>
            <li><a href="#" @click.prevent>用户管理</a></li>
            <li><a href="/users" hx-get="/users" hx-target="#main-container" hx-swap="innerHTML"
                    hx-push-url="true">用户列表</a></li>
            <li class="is-active"><a href="#" aria-current="page">新增用户</a></li>
        </ul>
    </nav>

    <!-- 表单卡片 -->
    <div class="content-card" style="max-width: 900px;">
        <div class="card-header">
            <h3 class="card-title">
                <i class="fas fa-user-plus has-text-primary"></i>
                新增用户
            </h3>
        </div>
        <div class="card-body">
            <!-- 错误提示框 -->
            {{if .Error}}
            <div class="notification is-danger is-light" style="margin-bottom: 1.5rem;">
                <button class="delete" onclick="this.parentElement.remove()"></button>
                <strong><i class="fas fa-exclamation-triangle"></i> 验证错误</strong>
                <p style="margin-top: 0.5rem;">{{.Error}}</p>
            </div>
            {{end}}

            <form hx-post="/users" hx-target="#main-container" hx-swap="innerHTML" x-data="userForm(false)"
                @submit="submitForm($event)" x-init="
                    {{if .FormData}}
                    form.username = '{{.FormData.Username}}';
                    form.email = '{{.FormData.Email}}';
                    form.realName = '{{.FormData.RealName}}';
                    form.phone = '{{.FormData.Phone}}';
                    form.role = '{{.FormData.Role}}';
                    form.status = '{{.FormData.Status}}';
                    {{end}}
                ">

                <div class="form-row">
                    <!-- 用户名 -->
                    <div class="field">
                        <label class="label">用户名 <span class="has-text-danger">*</span></label>
                        <div class="control has-icons-left">
                            <input class="input" type="text" name="username" placeholder="请输入用户名" required
                                x-model="form.username" :class="{'is-danger': errors.username}">
                            <span class="icon is-small is-left">
                                <i class="fas fa-user"></i>
                            </span>
                        </div>
                        <p class="help is-danger" x-show="errors.username" x-text="errors.username"></p>
                    </div>

                    <!-- 邮箱 -->
                    <div class="field">
                        <label class="label">邮箱 <span class="has-text-danger">*</span></label>
                        <div class="control has-icons-left">
                            <input class="input" type="email" name="email" placeholder="请输入邮箱" required
                                x-model="form.email" :class="{'is-danger': errors.email}">
                            <span class="icon is-small is-left">
                                <i class="fas fa-envelope"></i>
                            </span>
                        </div>
                        <p class="help is-danger" x-show="errors.email" x-text="errors.email"></p>
                    </div>
                </div>

                <div class="form-row">
                    <!-- 真实姓名 -->
                    <div class="field">
                        <label class="label">真实姓名 <span class="has-text-danger">*</span></label>
                        <div class="control has-icons-left">
                            <input class="input" type="text" name="real_name" placeholder="请输入真实姓名" required
                                x-model="form.realName" :class="{'is-danger': errors.realName}">
                            <span class="icon is-small is-left">
                                <i class="fas fa-id-card"></i>
                            </span>
                        </div>
                        <p class="help is-danger" x-show="errors.realName" x-text="errors.realName"></p>
                    </div>

                    <!-- 电话 -->
                    <div class="field">
                        <label class="label">电话</label>
                        <div class="control has-icons-left">
                            <input class="input" type="tel" name="phone" placeholder="请输入电话号码" x-model="form.phone"
                                pattern="^1[3-9]\d{9}$">
                            <span class="icon is-small is-left">
                                <i class="fas fa-phone"></i>
                            </span>
                        </div>
                        <p class="help">请输入11位手机号码</p>
                    </div>
                </div>

                <div class="form-row">
                    <!-- 角色 -->
                    <div class="field">
                        <label class="label">角色 <span class="has-text-danger">*</span></label>
                        <div class="control">
                            <div class="select is-fullwidth">
                                <select name="role" required x-model="form.role">
                                    <option value="">请选择角色</option>
                                    <option value="admin">管理员</option>
                                    <option value="editor">编辑</option>
                                    <option value="viewer">访客</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- 状态 -->
                    <div class="field">
                        <label class="label">状态 <span class="has-text-danger">*</span></label>
                        <div class="control">
                            <div class="select is-fullwidth">
                                <select name="status" required x-model="form.status">
                                    <option value="">请选择状态</option>
                                    <option value="active">活跃</option>
                                    <option value="inactive">非活跃</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 提交按钮 -->
                <div class="field is-grouped is-grouped-right" style="margin-top: 2rem;">
                    <div class="control">
                        <a href="/users" hx-get="/users" hx-target="#main-container" hx-swap="innerHTML"
                            hx-push-url="true" class="button is-light">
                            <span class="icon">
                                <i class="fas fa-times"></i>
                            </span>
                            <span>取消</span>
                        </a>
                    </div>
                    <div class="control">
                        <button type="submit" class="button is-primary" :class="{'is-loading': loading}"
                            :disabled="loading">
                            <span class="icon">
                                <i class="fas fa-save"></i>
                            </span>
                            <span>创建用户</span>
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>