<!-- 订单列表页面 -->
<div class="space-y-6">
    <!-- 页面标题 - 使用 hx-swap-oob 更新顶部标题 -->
    <div id="page-title" hx-swap-oob="true">订单管理</div>

    <div class="card bg-base-100 shadow-sm border border-base-300">
        <div class="card-body">
            
            <!-- 搜索和筛选栏 -->
            <div class="flex flex-col lg:flex-row gap-4 mb-6">
                <div class="flex-1 relative">
                    <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-base-content/40"></i>
                    <input class="input input-bordered w-full pl-10" type="search" name="keyword"
                        placeholder="搜索订单号、客户名称..." value="{{.Query}}" hx-get="/orders"
                        hx-trigger="keyup changed delay:500ms, search" hx-target="#order-table-container"
                        hx-swap="innerHTML" hx-select="#order-table-container > *" hx-include="[name='status']"
                        hx-indicator="#search-indicator">
                    <span class="absolute right-3 top-1/2 -translate-y-1/2 htmx-indicator" id="search-indicator">
                        <div class="loading loading-spinner loading-sm"></div>
                    </span>
                </div>

                <!-- 状态筛选 -->
                <div>
                    <select class="select select-bordered" name="status" hx-get="/orders" hx-trigger="change"
                        hx-target="#order-table-container" hx-swap="innerHTML" hx-select="#order-table-container > *"
                        hx-include="[name='keyword']">
                        <option value="">全部状态</option>
                        <option value="pending" {{if eq .Status "pending" }}selected{{end}}>待处理</option>
                        <option value="paid" {{if eq .Status "paid" }}selected{{end}}>已支付</option>
                        <option value="shipped" {{if eq .Status "shipped" }}selected{{end}}>已发货</option>
                        <option value="completed" {{if eq .Status "completed" }}selected{{end}}>已完成</option>
                        <option value="cancelled" {{if eq .Status "cancelled" }}selected{{end}}>已取消</option>
                    </select>
                </div>
            </div>

            <!-- 订单表格容器 -->
            <div id="order-table-container">
                {{if .Orders}}
                <div class="overflow-x-auto">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>订单号</th>
                                <th>客户名称</th>
                                <th>金额</th>
                                <th>支付方式</th>
                                <th>状态</th>
                                <th>创建时间</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="order-table-body">
                            {{range .Orders}}
                            {{template "orders/row.html" .}}
                            {{end}}
                        </tbody>
                    </table>
                </div>

                <!-- 分页 -->
                {{$ctx := dict "BaseURL" "/orders" "PageInfo" .PageInfo "TargetContainer" "order-table-container"
                "ExtraParams" (dict "keyword" .Query "status" .Status)}}
                {{template "components/pagination.html" $ctx}}
                {{else}}
                <div class="text-center py-12">
                    <i class="fas fa-shopping-cart text-6xl text-base-300 mb-4"></i>
                    <h3 class="text-lg font-medium mb-2">没有找到订单</h3>
                    <p class="text-base-content/60">尝试调整搜索条件</p>
                </div>
                {{end}}
            </div>
        </div>
    </div>
</div>