<!-- 仪表盘主页 -->
<div class="space-y-6">
    <!-- 统计卡片 - 每 30 秒自动刷新 -->
    <div id="stats-container" hx-get="/dashboard/stats" hx-trigger="every 30s" hx-swap="innerHTML">
        {{template "dashboard/stats.html" .Stats}}
    </div>

    <!-- 内容区域 -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- 最近订单 -->
        <div class="lg:col-span-2">
            <div class="card bg-base-100 shadow-sm border border-base-300 ">
                <div class="card-body">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="card-title text-lg font-medium flex items-center gap-2">
                            <i class="fas fa-shopping-cart text-info"></i>
                            最近订单
                        </h2>
                        <a href="/orders" class="btn btn-sm btn-ghost" hx-get="/orders" hx-target="#main-container"
                            hx-swap="innerHTML" hx-push-url="true">
                            查看全部
                        </a>
                    </div>

                    {{if .RecentOrders}}
                    <div class="overflow-x-auto">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>订单号</th>
                                    <th>客户</th>
                                    <th>金额</th>
                                    <th>状态</th>
                                    <th>创建时间</th>
                                </tr>
                            </thead>
                            <tbody>
                                {{range .RecentOrders}}
                                <tr class="hover">
                                    <td class="font-medium">{{.OrderNo}}</td>
                                    <td>{{.CustomerName}}</td>
                                    <td class="font-semibold">¥{{printf "%.2f" .TotalAmount}}</td>
                                    <td>
                                        {{if eq .Status "pending"}}
                                        <span class="badge badge-warning">待处理</span>
                                        {{else if eq .Status "paid"}}
                                        <span class="badge badge-info">已支付</span>
                                        {{else if eq .Status "shipped"}}
                                        <span class="badge badge-primary">已发货</span>
                                        {{else if eq .Status "completed"}}
                                        <span class="badge badge-success">已完成</span>
                                        {{end}}
                                    </td>
                                    <td>{{formatDateTime .CreatedAt}}</td>
                                </tr>
                                {{end}}
                            </tbody>
                        </table>
                    </div>
                    {{else}}
                    <div class="text-center py-12">
                        <i class="fas fa-inbox text-6xl text-base-300 mb-4"></i>
                        <p class="text-base-content/60">暂无订单数据</p>
                    </div>
                    {{end}}
                </div>
            </div>
        </div>

        <!-- 侧边栏信息 -->
        <div class="space-y-6">
            <!-- 最近用户 -->
            <div class="card bg-base-100 shadow-sm border border-base-300 ">
                <div class="card-body">
                    <h2 class="card-title text-lg font-medium flex items-center gap-2 mb-4">
                        <i class="fas fa-users text-success"></i>
                        最近注册
                    </h2>

                    {{if .RecentUsers}}
                    <div class="space-y-3">
                        {{range .RecentUsers}}
                        <div class="flex items-center gap-3 pb-3 border-b border-base-200 last:border-0 last:pb-0">
                            <div
                                class="w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">
                                {{substr .RealName 0 1}}
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="font-medium text-sm truncate">{{.RealName}}</div>
                                <div class="text-xs text-base-content/60 truncate">{{.Email}}</div>
                            </div>
                            <div class="flex-shrink-0">
                                {{if eq .Role "admin"}}
                                <span class="badge badge-error badge-xs">管理员</span>
                                {{else if eq .Role "editor"}}
                                <span class="badge badge-info badge-xs">编辑</span>
                                {{else}}
                                <span class="badge badge-outline badge-xs">访客</span>
                                {{end}}
                            </div>
                        </div>
                        {{end}}
                    </div>
                    {{else}}
                    <div class="text-center py-8">
                        <p class="text-base-content/60 text-sm">暂无用户数据</p>
                    </div>
                    {{end}}
                </div>
            </div>

            <!-- 热门商品 -->
            <div class="card bg-base-100 shadow-sm border border-base-300 ">
                <div class="card-body">
                    <h2 class="card-title text-lg font-medium flex items-center gap-2 mb-4">
                        <i class="fas fa-fire text-error"></i>
                        热门商品
                    </h2>

                    {{if .TopProducts}}
                    <div class="space-y-3">
                        {{range .TopProducts}}
                        <div class="flex items-center gap-3 pb-3 border-b border-base-200 last:border-0 last:pb-0">
                            <div
                                class="w-12 h-12 bg-base-200  flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-box text-2xl text-base-content/40"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="font-medium text-sm truncate">{{.Name}}</div>
                                <div class="text-xs text-base-content/60">库存: {{.Stock}}</div>
                            </div>
                            <div class="text-error font-semibold text-base flex-shrink-0">
                                ¥{{printf "%.2f" .Price}}
                            </div>
                        </div>
                        {{end}}
                    </div>
                    {{else}}
                    <div class="text-center py-8">
                        <p class="text-base-content/60 text-sm">暂无商品数据</p>
                    </div>
                    {{end}}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 页面标题 - 使用 hx-swap-oob 更新顶部标题 -->
<div id="page-title" hx-swap-oob="true">仪表盘</div>