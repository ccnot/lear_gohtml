<!-- 仪表盘主页 -->
<div>
    <!-- 页面标题 - 使用 hx-swap-oob 更新顶部标题 -->
    <div id="page-title" hx-swap-oob="true">仪表盘</div>

    <!-- 统计卡片 - 每 30 秒自动刷新 -->
    <div id="stats-container" hx-get="/dashboard/stats" hx-trigger="every 30s" hx-swap="innerHTML">
        {{template "dashboard/stats.html" .Stats}}
    </div>

    <!-- 内容区域 -->
    <div class="uk-grid-medium" uk-grid>
        <!-- 最近订单 -->
        <div class="uk-width-2-3@l uk-width-1-1@m">
            <div class="content-card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-shopping-cart" style="color: var(--info-color);"></i>
                        最近订单
                    </h3>
                    <a href="/orders" class="uk-button uk-button-small uk-button-default" hx-get="/orders"
                        hx-target="#main-container" hx-swap="innerHTML" hx-push-url="true">
                        查看全部
                    </a>
                </div>
                <div class="card-body">
                    {{if .RecentOrders}}
                    <table class="uk-table uk-table-hover uk-table-divider uk-table-middle">
                        <thead>
                            <tr>
                                <th>订单号</th>
                                <th>客户</th>
                                <th>金额</th>
                                <th>状态</th>
                                <th>创建时间</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{range .RecentOrders}}
                            <tr>
                                <td><strong>{{.OrderNo}}</strong></td>
                                <td>{{.CustomerName}}</td>
                                <td style="font-weight: 600;">¥{{printf "%.2f" .TotalAmount}}</td>
                                <td>
                                    {{if eq .Status "pending"}}
                                    <span class="badge warning">待处理</span>
                                    {{else if eq .Status "paid"}}
                                    <span class="badge info">已支付</span>
                                    {{else if eq .Status "shipped"}}
                                    <span class="badge primary">已发货</span>
                                    {{else if eq .Status "completed"}}
                                    <span class="badge success">已完成</span>
                                    {{end}}
                                </td>
                                <td>{{.CreatedAt.Format "2006-01-02 15:04"}}</td>
                            </tr>
                            {{end}}
                        </tbody>
                    </table>
                    {{else}}
                    <div class="empty-state">
                        <div class="empty-state-icon"><i class="fas fa-inbox"></i></div>
                        <div class="empty-state-text">暂无订单数据</div>
                    </div>
                    {{end}}
                </div>
            </div>
        </div>

        <!-- 侧边栏信息 -->
        <div class="uk-width-1-3@l uk-width-1-1@m">
            <!-- 最近用户 -->
            <div class="content-card" style="margin-bottom: 24px;">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-users" style="color: var(--success-color);"></i>
                        最近注册
                    </h3>
                </div>
                <div class="card-body">
                    {{if .RecentUsers}}
                    {{range .RecentUsers}}
                    <div
                        style="display: flex; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border-light);">
                        <div
                            style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; margin-right: 12px; font-size: 14px;">
                            {{substr .RealName 0 1}}
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: 500; font-size: 14px;">{{.RealName}}</div>
                            <div style="font-size: 12px; color: var(--text-tertiary);">{{.Email}}</div>
                        </div>
                        <div>
                            {{if eq .Role "admin"}}
                            <span class="uk-label uk-label-danger" style="font-size: 11px;">管理员</span>
                            {{else if eq .Role "editor"}}
                            <span class="uk-label" style="font-size: 11px; background: var(--info-color);">编辑</span>
                            {{else}}
                            <span class="uk-label" style="font-size: 11px;">访客</span>
                            {{end}}
                        </div>
                    </div>
                    {{end}}
                    {{else}}
                    <div class="empty-state">
                        <p style="color: var(--text-tertiary);">暂无用户数据</p>
                    </div>
                    {{end}}
                </div>
            </div>

            <!-- 热门商品 -->
            <div class="content-card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-fire" style="color: var(--error-color);"></i>
                        热门商品
                    </h3>
                </div>
                <div class="card-body">
                    {{if .TopProducts}}
                    {{range .TopProducts}}
                    <div
                        style="display: flex; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border-light);">
                        <div
                            style="width: 50px; height: 50px; background: var(--bg-hover); border-radius: var(--radius-base); margin-right: 12px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-box" style="font-size: 24px; color: var(--text-disabled);"></i>
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: 500; font-size: 14px;">{{.Name}}</div>
                            <div style="font-size: 12px; color: var(--text-tertiary);">库存: {{.Stock}}</div>
                        </div>
                        <div style="color: var(--error-color); font-weight: 600; font-size: 16px;">
                            ¥{{printf "%.2f" .Price}}
                        </div>
                    </div>
                    {{end}}
                    {{else}}
                    <div class="empty-state">
                        <p style="color: var(--text-tertiary);">暂无商品数据</p>
                    </div>
                    {{end}}
                </div>
            </div>
        </div>
    </div>
</div>